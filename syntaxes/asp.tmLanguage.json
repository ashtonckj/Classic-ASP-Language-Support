{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "ASP",
    "scopeName": "text.html.asp",
    "comment": "Classic ASP with HTML",
    "fileTypes": [
        "asp",
        "asa"
    ],
    "foldingStartMarker": "(?i)^\\s*(Public|Private)?\\s*(Class|Function|Sub|Property)\\s*([a-zA-Z_]\\w*)\\s*(\\(.*\\)\\s*)?$",
    "foldingStopMarker": "(?i)^\\s*End (Class|Function|Sub|Property)\\s*$",
    "injections": {
        "text.html.asp": {
            "patterns": [
                {
                    "include": "#asp-output-block"
                },
                {
                    "include": "#asp-code-block"
                }
            ]
        }
    },
    "patterns": [
        {
            "include": "text.html.basic"
        }
    ],
    "repository": {
        "asp-code-block": {
            "name": "meta.embedded.block.asp",
            "begin": "\\s*<%(?!=)",
            "end": "%>",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.section.embedded.begin.asp"
                }
            },
            "endCaptures": {
                "0": {
                    "name": "punctuation.section.embedded.end.asp"
                }
            },
            "contentName": "source.asp",
            "patterns": [
                {
                    "include": "#vbscript-code"
                }
            ]
        },
        "asp-output-block": {
            "name": "meta.embedded.expression.asp",
            "begin": "\\s*<%=",
            "end": "%>",
            "beginCaptures": {
                "0": {
                    "name": "punctuation.section.embedded.begin.asp"
                }
            },
            "endCaptures": {
                "0": {
                    "name": "punctuation.section.embedded.end.asp"
                }
            },
            "contentName": "source.asp",
            "patterns": [
                {
                    "include": "#vbscript-code"
                }
            ]
        },
        "vbscript-code": {
            "patterns": [
                {
                    "include": "#comments"
                },
                {
                    "include": "#strings"
                },
                {
                    "include": "#function-declaration"
                },
                {
                    "include": "#keywords"
                },
                {
                    "include": "#constants"
                },
                {
                    "include": "#asp-objects"
                },
                {
                    "include": "#operators"
                },
                {
                    "include": "#numbers"
                },
                {
                    "include": "#functions"
                }
            ]
        },
        "comments": {
            "patterns": [
                {
                    "name": "comment.line.apostrophe.asp",
                    "begin": "(^[ \\t]+)?(?=')",
                    "beginCaptures": {
                        "1": {
                            "name": "punctuation.whitespace.comment.leading.asp"
                        }
                    },
                    "end": "(?!\\G)",
                    "patterns": [
                        {
                            "name": "comment.line.apostrophe.asp",
                            "begin": "'",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.definition.comment.asp"
                                }
                            },
                            "end": "\\n|(?=%>)"
                        }
                    ]
                },
                {
                    "name": "comment.line.rem.asp",
                    "begin": "(^[ \\t]+)?(?i:(?=REM ))",
                    "beginCaptures": {
                        "1": {
                            "name": "punctuation.whitespace.comment.leading.asp"
                        }
                    },
                    "end": "(?!\\G)",
                    "patterns": [
                        {
                            "name": "comment.line.rem.asp",
                            "begin": "(?i:REM )",
                            "beginCaptures": {
                                "0": {
                                    "name": "punctuation.definition.comment.asp"
                                }
                            },
                            "end": "\\n|(?=%>)"
                        }
                    ]
                }
            ]
        },
        "strings": {
            "patterns": [
                {
                    "comment": "SQL strings - detect by any SQL keyword (liberal matching for best colors)",
                    "name": "string.quoted.double.asp",
                    "begin": "\"(?=(?i).*?(\\b(SELECT|INSERT|UPDATE|DELETE|CREATE|DROP|ALTER|TRUNCATE|FROM|WHERE|AND|OR|JOIN|SET|INTO|UNION|ORDER|GROUP|HAVING|AS|LIKE|IS|NOT|CASE|WHEN|THEN|ELSE|END|VALUES)|\\[[^\\]]+\\]\\.|WITH\\s*\\(|\\bAS\\b.*?,))",
                    "end": "\"(?!\")",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.definition.string.begin.asp"
                        }
                    },
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.definition.string.end.asp"
                        }
                    },
                    "patterns": [
                        {
                            "include": "#sql-syntax"
                        },
                        {
                            "name": "constant.character.escape.apostrophe.asp",
                            "match": "\"\""
                        }
                    ]
                },
                {
                    "comment": "Regular strings - fallback for non-SQL strings",
                    "name": "string.quoted.double.asp",
                    "begin": "\"",
                    "end": "\"(?!\")",
                    "beginCaptures": {
                        "0": {
                            "name": "punctuation.definition.string.begin.asp"
                        }
                    },
                    "endCaptures": {
                        "0": {
                            "name": "punctuation.definition.string.end.asp"
                        }
                    },
                    "patterns": [
                        {
                            "name": "constant.character.escape.apostrophe.asp",
                            "match": "\"\""
                        }
                    ]
                }
            ]
        },
        "sql-syntax": {
            "patterns": [
                {
                    "name": "constant.character.escape.apostrophe.asp",
                    "match": "\"\""
                },
                {
                    "comment": "WITH (NOLOCK) and other table hints - must come early",
                    "name": "keyword.other.sql",
                    "match": "(?i)\\bWITH\\s*\\(\\s*(NOLOCK|READUNCOMMITTED|UPDLOCK|ROWLOCK|TABLOCK|HOLDLOCK)\\s*\\)"
                },
                {
                    "comment": "Multi-word SQL phrases - MUST come before single keywords",
                    "name": "keyword.other.DML.sql",
                    "match": "(?i)\\b(IS\\s+NOT\\s+NULL|IS\\s+NULL|NOT\\s+NULL|AND\\s+LIKE|ORDER\\s+BY|GROUP\\s+BY|UNION\\s+ALL|LEFT\\s+OUTER\\s+JOIN|RIGHT\\s+OUTER\\s+JOIN|FULL\\s+OUTER\\s+JOIN|LEFT\\s+JOIN|RIGHT\\s+JOIN|INNER\\s+JOIN|OUTER\\s+JOIN|FULL\\s+JOIN|CROSS\\s+JOIN|CROSS\\s+APPLY|OUTER\\s+APPLY|INSERT\\s+INTO|DELETE\\s+FROM)\\b"
                },
                {
                    "comment": "SQL DML commands",
                    "name": "keyword.other.DML.sql",
                    "match": "(?i)\\b(SELECT|INSERT|UPDATE|DELETE|FROM|WHERE|JOIN|ON|HAVING|DISTINCT|TOP|LIMIT|OFFSET|FETCH|UNION|INTERSECT|EXCEPT|BY|ORDER|GROUP|APPLY)\\b"
                },
                {
                    "comment": "SQL DDL commands",
                    "name": "keyword.other.DDL.sql",
                    "match": "(?i)\\b(CREATE|DROP|ALTER|TRUNCATE|TABLE|INDEX|VIEW|DATABASE|PROCEDURE|FUNCTION|TRIGGER|SCHEMA)\\b"
                },
                {
                    "comment": "SQL logical operators",
                    "name": "keyword.operator.logical.sql",
                    "match": "(?i)\\b(AND|OR|NOT|IN|IS|LIKE|BETWEEN|EXISTS|ANY|ALL|SOME)\\b"
                },
                {
                    "comment": "SQL comparison operators",
                    "name": "keyword.operator.comparison.sql",
                    "match": "(<>|!=|<=|>=|<|>|=)"
                },
                {
                    "comment": "SQL keywords",
                    "name": "keyword.other.sql",
                    "match": "(?i)\\b(AS|ASC|DESC|SET|VALUES|INTO|CASE|WHEN|THEN|ELSE|END|WITH|NOLOCK|DEFAULT|CONSTRAINT|PRIMARY|FOREIGN|KEY|UNIQUE|REFERENCES|CHECK|COLLATE|BEGIN|COMMIT|ROLLBACK|TRANSACTION|DECLARE|CURSOR|OPEN|CLOSE|DEALLOCATE)\\b"
                },
                {
                    "comment": "SQL aggregate and window functions",
                    "name": "support.function.aggregate.sql",
                    "match": "(?i)\\b(COUNT|SUM|AVG|MAX|MIN|ROW_NUMBER|RANK|DENSE_RANK|NTILE|PARTITION|OVER|LEAD|LAG|FIRST_VALUE|LAST_VALUE)\\b"
                },
                {
                    "comment": "SQL string functions",
                    "name": "support.function.string.sql",
                    "match": "(?i)\\b(SUBSTRING|LEN|LENGTH|UPPER|LOWER|TRIM|LTRIM|RTRIM|CONCAT|CONCAT_WS|REPLACE|CHARINDEX|PATINDEX|STUFF|LEFT|RIGHT|REVERSE|REPLICATE|SPACE|SOUNDEX|DIFFERENCE|ASCII|CHAR|NCHAR|UNICODE|QUOTENAME)\\b"
                },
                {
                    "comment": "SQL date/time functions",
                    "name": "support.function.datetime.sql",
                    "match": "(?i)\\b(GETDATE|GETUTCDATE|SYSDATETIME|SYSUTCDATETIME|SYSDATETIMEOFFSET|CURRENT_TIMESTAMP|DATEADD|DATEDIFF|DATEDIFF_BIG|DATEPART|DATENAME|YEAR|MONTH|DAY|HOUR|MINUTE|SECOND|MILLISECOND|MICROSECOND|NANOSECOND|DAYOFWEEK|DAYOFYEAR|WEEK|WEEKDAY|QUARTER|CONVERT|CAST|FORMAT|TRY_CAST|TRY_CONVERT|PARSE|TRY_PARSE|EOMONTH|DATEFROMPARTS|DATETIME2FROMPARTS|DATETIMEFROMPARTS|DATETIMEOFFSETFROMPARTS|SMALLDATETIMEFROMPARTS|TIMEFROMPARTS|ISDATE)\\b"
                },
                {
                    "comment": "SQL mathematical functions",
                    "name": "support.function.math.sql",
                    "match": "(?i)\\b(ABS|CEILING|FLOOR|ROUND|POWER|SQRT|EXP|LOG|LOG10|PI|SIN|COS|TAN|ASIN|ACOS|ATAN|ATN2|DEGREES|RADIANS|SIGN|RAND|SQUARE)\\b"
                },
                {
                    "comment": "SQL NULL-handling functions",
                    "name": "support.function.null.sql",
                    "match": "(?i)\\b(ISNULL|COALESCE|NULLIF|IFNULL)\\b"
                },
                {
                    "comment": "SQL conditional functions",
                    "name": "support.function.conditional.sql",
                    "match": "(?i)\\b(IIF|CHOOSE)\\b"
                },
                {
                    "comment": "SQL conversion functions",
                    "name": "support.function.conversion.sql",
                    "match": "(?i)\\b(CAST|CONVERT|TRY_CAST|TRY_CONVERT|PARSE|TRY_PARSE)\\b"
                },
                {
                    "comment": "NULL constant",
                    "name": "constant.language.null.sql",
                    "match": "(?i)\\bNULL\\b"
                },
                {
                    "comment": "SQL data types",
                    "name": "storage.type.sql",
                    "match": "(?i)\\b(VARCHAR|NVARCHAR|CHAR|NCHAR|TEXT|NTEXT|INT|INTEGER|BIGINT|SMALLINT|TINYINT|DECIMAL|NUMERIC|FLOAT|REAL|MONEY|SMALLMONEY|BIT|DATE|DATETIME|DATETIME2|SMALLDATETIME|TIME|DATETIMEOFFSET|TIMESTAMP|UNIQUEIDENTIFIER|GUID|XML|VARBINARY|BINARY|IMAGE|SQL_VARIANT|HIERARCHYID|GEOMETRY|GEOGRAPHY)\\b"
                },
                {
                    "comment": "SQL boolean literals",
                    "name": "constant.language.boolean.sql",
                    "match": "(?i)\\b(TRUE|FALSE)\\b"
                },
                {
                    "comment": "SQL numeric literals",
                    "name": "constant.numeric.sql",
                    "match": "\\b\\d+(\\.\\d+)?([eE][+-]?\\d+)?\\b"
                },
                {
                    "comment": "SQL wildcard (SELECT *)",
                    "name": "keyword.operator.star.sql",
                    "match": "(?<=\\s)\\*(?=\\s|,|$)"
                },
                {
                    "comment": "SQL parameter/variable prefix (@var)",
                    "name": "variable.parameter.sql",
                    "match": "@[a-zA-Z_][a-zA-Z0-9_]*"
                },
                {
                    "comment": "SQL table.column or alias.column pattern (a.RowID, b.Company)",
                    "name": "meta.column-reference.sql",
                    "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\.(\\*|[a-zA-Z_][a-zA-Z0-9_]*)",
                    "captures": {
                        "1": {
                            "name": "variable.other.table.sql"
                        },
                        "2": {
                            "name": "variable.other.column.sql"
                        }
                    }
                },
                {
                    "comment": "SQL identifier brackets [table], [column]",
                    "name": "entity.name.identifier.sql",
                    "match": "\\[[^\\]]+\\]"
                }
            ]
        },
        "function-declaration": {
            "patterns": [
                {
                    "name": "meta.function.asp",
                    "match": "(?i)^\\s*(function|sub)\\s+([a-zA-Z_]\\w*)\\s*(\\()([^)]*)(\\)).*\\n?",
                    "captures": {
                        "1": {
                            "name": "storage.type.function.asp"
                        },
                        "2": {
                            "name": "entity.name.function.asp"
                        },
                        "3": {
                            "name": "punctuation.definition.parameters.asp"
                        },
                        "4": {
                            "name": "variable.parameter.function.asp"
                        },
                        "5": {
                            "name": "punctuation.definition.parameters.asp"
                        }
                    }
                }
            ]
        },
        "keywords": {
            "patterns": [
                {
                    "name": "keyword.control.asp",
                    "match": "(?i)\\b(If|Then|Else|ElseIf|End\\s+If|While|Wend|For|To|Each|In|Step|Case|Select|End\\s+Select|Return|Continue|Do|Until|Loop|Next|With|End\\s+With|Exit\\s+Do|Exit\\s+For|Exit\\s+Function|Exit\\s+Property|Exit\\s+Sub|GoTo)\\b"
                },
                {
                    "name": "storage.type.asp",
                    "match": "(?i)\\b(Call|Class|Const|Dim|ReDim|Function|Sub|Property|End\\s+Property|End\\s+Sub|End\\s+Function|End\\s+Class|Set|Let|Get|New|Randomize|Option\\s+Explicit|On\\s+Error\\s+Resume\\s+Next|On\\s+Error\\s+GoTo)\\b"
                },
                {
                    "name": "storage.modifier.asp",
                    "match": "(?i)\\b(Private|Public|Default)\\b"
                },
                {
                    "name": "keyword.operator.logical.asp",
                    "match": "(?i)\\b(And|Or|Not|Xor|Eqv|Imp|Is)\\b"
                }
            ]
        },
        "constants": {
            "patterns": [
                {
                    "name": "constant.language.asp",
                    "match": "(?i)\\b(Empty|False|Nothing|Null|True)\\b"
                },
                {
                    "name": "support.type.vb.asp",
                    "match": "(?i)\\b(vbTrue|vbFalse|vbCr|vbCrLf|vbFormFeed|vbLf|vbNewLine|vbNullChar|vbNullString|vbTab|vbVerticalTab|vbBinaryCompare|vbTextCompare|vbSunday|vbMonday|vbTuesday|vbWednesday|vbThursday|vbFriday|vbSaturday|vbUseSystemDayOfWeek|vbFirstJan1|vbFirstFourDays|vbFirstFullWeek|vbGeneralDate|vbLongDate|vbShortDate|vbLongTime|vbShortTime|vbObjectError|vbEmpty|vbNull|vbInteger|vbLong|vbSingle|vbDouble|vbCurrency|vbDate|vbString|vbObject|vbError|vbBoolean|vbVariant|vbDataObject|vbDecimal|vbByte|vbArray)\\b"
                }
            ]
        },
        "asp-objects": {
            "patterns": [
                {
                    "comment": "ASP object.method or object.property pattern - must come first",
                    "name": "meta.object-access.asp",
                    "match": "(?i)\\b(Application|ObjectContext|Request|Response|Server|Session)\\.(\\w+)",
                    "captures": {
                        "1": {
                            "name": "support.class.asp"
                        },
                        "2": {
                            "name": "support.function.asp"
                        }
                    }
                },
                {
                    "name": "support.class.asp",
                    "match": "(?i)\\b(Application|ObjectContext|Request|Response|Server|Session)\\b"
                },
                {
                    "name": "support.class.collection.asp",
                    "match": "(?i)\\b(Contents|StaticObjects|ClientCertificate|Cookies|Form|QueryString|ServerVariables)\\b"
                },
                {
                    "name": "support.constant.asp",
                    "match": "(?i)\\b(TotalBytes|Buffer|CacheControl|Charset|ContentType|Expires|ExpiresAbsolute|IsClientConnected|PICS|Status|ScriptTimeout|CodePage|LCID|SessionID|Timeout)\\b"
                },
                {
                    "name": "support.function.asp",
                    "match": "(?i)\\b(Lock|Unlock|SetAbort|SetComplete|BinaryRead|AddHeader|AppendToLog|BinaryWrite|Clear|End|Flush|Redirect|Write|CreateObject|HTMLEncode|MapPath|URLEncode|Abandon)\\b"
                },
                {
                    "name": "support.function.event.asp",
                    "match": "(?i)\\b(Application_OnEnd|Application_OnStart|OnTransactionAbort|OnTransactionCommit|Session_OnEnd|Session_OnStart|Class_Initialize|Class_Terminate)\\b"
                }
            ]
        },
        "operators": {
            "patterns": [
                {
                    "name": "keyword.operator.asp",
                    "match": "=|>=|<=|<>|<|>|\\+|-|\\*|/|\\\\|\\^|&|(?i)\\b(Mod)\\b"
                }
            ]
        },
        "numbers": {
            "patterns": [
                {
                    "name": "constant.numeric.asp",
                    "match": "\\b((0(x|X)[0-9a-fA-F]*)|(([0-9]+\\.?[0-9]*)|(\\.[0-9]+))((e|E)(\\+|-)?[0-9]+)?)(L|l|UL|ul|u|U|F|f)?\\b"
                }
            ]
        },
        "functions": {
            "patterns": [
                {
                    "name": "support.function.vb.asp",
                    "match": "(?i)\\b(Array|Add|Asc|Atn|CBool|CByte|CCur|CDate|CDbl|Chr|CInt|CLng|Conversions|Cos|CreateObject|CSng|CStr|Date|DateAdd|DateDiff|DatePart|DateSerial|DateValue|Day|Derived|Math|Escape|Eval|Exists|Exp|Filter|FormatCurrency|FormatDateTime|FormatNumber|FormatPercent|GetLocale|GetObject|GetRef|Hex|Hour|InputBox|InStr|InStrRev|Int|Fix|IsArray|IsDate|IsEmpty|IsNull|IsNumeric|IsObject|Item|Items|Join|Keys|LBound|LCase|Left|Len|LoadPicture|Log|LTrim|RTrim|Trim|Maths|Mid|Minute|Month|MonthName|MsgBox|Now|Oct|Remove|RemoveAll|Replace|RGB|Right|Rnd|Round|ScriptEngine|ScriptEngineBuildVersion|ScriptEngineMajorVersion|ScriptEngineMinorVersion|Second|SetLocale|Sgn|Sin|Space|Split|Sqr|StrComp|String|StrReverse|Tan|Time|Timer|TimeSerial|TimeValue|TypeName|UBound|UCase|Unescape|VarType|Weekday|WeekdayName|Year)\\b"
                }
            ]
        }
    }
}